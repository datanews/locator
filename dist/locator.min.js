/**
 * locator - In browser locator map generator
 * @version v0.0.2
 * @link https://github.com/datanews/locator#readme
 * @license MIT
 * @notes External libraries may be bundled here and their respective, original license applies.
 */
!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Locator=t()}}(function(){var t;return function e(t,i,o){function n(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+r+"'")}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){var i=t[r][1][e];return n(i?i:e)},d,d.exports,e,t,i,o)}return i[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)n(o[r]);return n}({html2canvas:[function(t,e,i){e.exports=t("UzntfK")},{}],UzntfK:[function(t,e,i){(function(t){(function(t,e,i,o){!function(t,e,i){"use strict";function o(t,e,i){var o,n=t.runtimeStyle&&t.runtimeStyle[e],a=t.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(i)&&/^-?\d/.test(i)&&(o=a.left,n&&(t.runtimeStyle.left=t.currentStyle.left),a.left="fontSize"===e?"1em":i||0,i=a.pixelLeft+"px",a.left=o,n&&(t.runtimeStyle.left=n)),/^(thin|medium|thick)$/i.test(i)?i:Math.round(parseFloat(i))+"px"}function n(t){return parseInt(t,10)}function a(t,e,n,a){if(t=(t||"").split(","),t=t[a||0]||t[0]||"auto",t=h.Util.trimText(t).split(" "),"backgroundSize"!==n||t[0]&&!t[0].match(/cover|contain|auto/)){if(t[0]=-1===t[0].indexOf("%")?o(e,n+"X",t[0]):t[0],t[1]===i){if("backgroundSize"===n)return t[1]="auto",t;t[1]=t[0]}t[1]=-1===t[1].indexOf("%")?o(e,n+"Y",t[1]):t[1]}else;return t}function r(t,e,i,o,n,a){var r,s,l,d,c=h.Util.getCSS(e,t,n);if(1===c.length&&(d=c[0],c=[],c[0]=d,c[1]=d),-1!==c[0].toString().indexOf("%"))l=parseFloat(c[0])/100,s=i.width*l,"backgroundSize"!==t&&(s-=(a||o).width*l);else if("backgroundSize"===t)if("auto"===c[0])s=o.width;else if(/contain|cover/.test(c[0])){var p=h.Util.resizeBounds(o.width,o.height,i.width,i.height,c[0]);s=p.width,r=p.height}else s=parseInt(c[0],10);else s=parseInt(c[0],10);return"auto"===c[1]?r=s/o.width*o.height:-1!==c[1].toString().indexOf("%")?(l=parseFloat(c[1])/100,r=i.height*l,"backgroundSize"!==t&&(r-=(a||o).height*l)):r=parseInt(c[1],10),[s,r]}function s(t,e){var i=[];return{storage:i,width:t,height:e,clip:function(){i.push({type:"function",name:"clip",arguments:arguments})},translate:function(){i.push({type:"function",name:"translate",arguments:arguments})},fill:function(){i.push({type:"function",name:"fill",arguments:arguments})},save:function(){i.push({type:"function",name:"save",arguments:arguments})},restore:function(){i.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){i.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){i.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var t=[];return i.push({type:"function",name:"drawShape",arguments:t}),{moveTo:function(){t.push({name:"moveTo",arguments:arguments})},lineTo:function(){t.push({name:"lineTo",arguments:arguments})},arcTo:function(){t.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){t.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){t.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){i.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){i.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(t,e){return i.push({type:"variable",name:t,arguments:e}),e}}}function l(t){return{zindex:t,children:[]}}var d,c,h={};h.Util={},h.Util.log=function(e){h.logging&&t.console&&t.console.log&&t.console.log(e)},h.Util.trimText=function(t){return function(e){return t?t.apply(e):((e||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),h.Util.asFloat=function(t){return parseFloat(t)},function(){var t=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,e=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;h.Util.parseTextShadows=function(i){if(!i||"none"===i)return[];for(var o=i.match(t),n=[],a=0;o&&a<o.length;a++){var r=o[a].match(e);n.push({color:r[0],offsetX:r[1]?r[1].replace("px",""):0,offsetY:r[2]?r[2].replace("px",""):0,blur:r[3]?r[3].replace("px",""):0})}return n}}(),h.Util.parseBackgroundImage=function(t){var e,i,o,n,a,r,s,l,d=" \r\n	",c=[],h=0,p=0,u=function(){e&&('"'===i.substr(0,1)&&(i=i.substr(1,i.length-2)),i&&l.push(i),"-"===e.substr(0,1)&&(n=e.indexOf("-",1)+1)>0&&(o=e.substr(0,n),e=e.substr(n)),c.push({prefix:o,method:e.toLowerCase(),value:a,args:l})),l=[],e=o=i=a=""};u();for(var g=0,f=t.length;f>g;g++)if(r=t[g],!(0===h&&d.indexOf(r)>-1)){switch(r){case'"':s?s===r&&(s=null):s=r;break;case"(":if(s)break;if(0===h){h=1,a+=r;continue}p++;break;case")":if(s)break;if(1===h){if(0===p){h=0,a+=r,u();continue}p--}break;case",":if(s)break;if(0===h){u();continue}if(1===h&&0===p&&!e.match(/^url$/i)){l.push(i),i="",a+=r;continue}}a+=r,0===h?e+=r:i+=r}return u(),c},h.Util.Bounds=function(t){var e,i={};return t.getBoundingClientRect&&(e=t.getBoundingClientRect(),i.top=Math.floor(e.top),i.bottom=Math.floor(e.bottom||e.top+e.height),i.left=Math.floor(e.left),i.width=Math.floor(t.offsetWidth),i.height=Math.floor(t.offsetHeight)),i},h.Util.OffsetBounds=function(t){var e=t.offsetParent?h.Util.OffsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},h.Util.getCSS=function(t,i,o){d!==t&&(c=e.defaultView.getComputedStyle(t,null));var r=c[i];if(/^background(Size|Position)$/.test(i))return a(r,t,i,o);if(/border(Top|Bottom)(Left|Right)Radius/.test(i)){var s=r.split(" ");return s.length<=1&&(s[1]=s[0]),s.map(n)}return r},h.Util.resizeBounds=function(t,e,i,o,n){var a,r,s=i/o,l=t/e;return n&&"auto"!==n?l>s^"contain"===n?(r=o,a=o*l):(a=i,r=i/l):(a=i,r=o),{width:a,height:r}},h.Util.BackgroundPosition=function(t,e,i,o,n){var a=r("backgroundPosition",t,e,i,o,n);return{left:a[0],top:a[1]}},h.Util.BackgroundSize=function(t,e,i,o){var n=r("backgroundSize",t,e,i,o);return{width:n[0],height:n[1]}},h.Util.Extend=function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},h.Util.Children=function(t){var e;try{e=t.nodeName&&"IFRAME"===t.nodeName.toUpperCase()?t.contentDocument||t.contentWindow.document:function(t){var e=[];return null!==t&&!function(t,e){var o=t.length,n=0;if("number"==typeof e.length)for(var a=e.length;a>n;n++)t[o++]=e[n];else for(;e[n]!==i;)t[o++]=e[n++];return t.length=o,t}(e,t),e}(t.childNodes)}catch(o){h.Util.log("html2canvas.Util.Children failed with exception: "+o.message),e=[]}return e},h.Util.isTransparent=function(t){return"transparent"===t||"rgba(0, 0, 0, 0)"===t},h.Util.Font=function(){var t={};return function(e,o,n){if(t[e+"-"+o]!==i)return t[e+"-"+o];var a,r,s,l=n.createElement("div"),d=n.createElement("img"),c=n.createElement("span"),h="Hidden Text";return l.style.visibility="hidden",l.style.fontFamily=e,l.style.fontSize=o,l.style.margin=0,l.style.padding=0,n.body.appendChild(l),d.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",d.width=1,d.height=1,d.style.margin=0,d.style.padding=0,d.style.verticalAlign="baseline",c.style.fontFamily=e,c.style.fontSize=o,c.style.margin=0,c.style.padding=0,c.appendChild(n.createTextNode(h)),l.appendChild(c),l.appendChild(d),a=d.offsetTop-c.offsetTop+1,l.removeChild(c),l.appendChild(n.createTextNode(h)),l.style.lineHeight="normal",d.style.verticalAlign="super",r=d.offsetTop-l.offsetTop+1,s={baseline:a,lineWidth:1,middle:r},t[e+"-"+o]=s,n.body.removeChild(l),s}}(),function(){function t(t){return function(e){try{t.addColorStop(e.stop,e.color)}catch(o){i.log(["failed to add color stop: ",o,"; tried to add: ",e])}}}var i=h.Util,o={};h.Generate=o;var n=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];o.parseGradient=function(t,e){var i,o,a,r,s,l,d,c,h,p,u,g,f=n.length;for(o=0;f>o&&!(a=t.match(n[o]));o+=1);if(a)switch(a[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(i={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},s=a[2].match(/\w+/g))for(l=s.length,o=0;l>o;o+=1)switch(s[o]){case"top":i.y0=0,i.y1=e.height;break;case"right":i.x0=e.width,i.x1=0;break;case"bottom":i.y0=e.height,i.y1=0;break;case"left":i.x0=0,i.x1=e.width}if(null===i.x0&&null===i.x1&&(i.x0=i.x1=e.width/2),null===i.y0&&null===i.y1&&(i.y0=i.y1=e.height/2),s=a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,d=1/Math.max(l-1,1),o=0;l>o;o+=1)c=s[o].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),c[2]?(r=parseFloat(c[2]),r/="%"===c[3]?100:e.width):r=o*d,i.colorStops.push({color:c[1],stop:r});break;case"-webkit-gradient":if(i={type:"radial"===a[2]?"circle":a[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},s=a[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),s&&(i.x0=s[1]*e.width/100,i.y0=s[2]*e.height/100,i.x1=s[3]*e.width/100,i.y1=s[4]*e.height/100),s=a[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(l=s.length,o=0;l>o;o+=1)c=s[o].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),r=parseFloat(c[2]),"from"===c[1]&&(r=0),"to"===c[1]&&(r=1),i.colorStops.push({color:c[3],stop:r});break;case"-moz-linear-gradient":if(i={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},s=a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),s&&(i.x0=s[1]*e.width/100,i.y0=s[2]*e.height/100,i.x1=e.width-i.x0,i.y1=e.height-i.y0),s=a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(l=s.length,d=1/Math.max(l-1,1),o=0;l>o;o+=1)c=s[o].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),c[2]?(r=parseFloat(c[2]),c[3]&&(r/=100)):r=o*d,i.colorStops.push({color:c[1],stop:r});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(i={type:"circle",x0:0,y0:0,x1:e.width,y1:e.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},s=a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),s&&(i.cx=s[1]*e.width/100,i.cy=s[2]*e.height/100),s=a[3].match(/\w+/),c=a[4].match(/[a-z\-]*/),s&&c)switch(c[0]){case"farthest-corner":case"cover":case"":h=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.cy,2)),p=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.y1-i.cy,2)),u=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.y1-i.cy,2)),g=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.cy,2)),i.rx=i.ry=Math.max(h,p,u,g);break;case"closest-corner":h=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.cy,2)),p=Math.sqrt(Math.pow(i.cx,2)+Math.pow(i.y1-i.cy,2)),u=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.y1-i.cy,2)),g=Math.sqrt(Math.pow(i.x1-i.cx,2)+Math.pow(i.cy,2)),i.rx=i.ry=Math.min(h,p,u,g);break;case"farthest-side":"circle"===s[0]?i.rx=i.ry=Math.max(i.cx,i.cy,i.x1-i.cx,i.y1-i.cy):(i.type=s[0],i.rx=Math.max(i.cx,i.x1-i.cx),i.ry=Math.max(i.cy,i.y1-i.cy));break;case"closest-side":case"contain":"circle"===s[0]?i.rx=i.ry=Math.min(i.cx,i.cy,i.x1-i.cx,i.y1-i.cy):(i.type=s[0],i.rx=Math.min(i.cx,i.x1-i.cx),i.ry=Math.min(i.cy,i.y1-i.cy))}if(s=a[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,d=1/Math.max(l-1,1),o=0;l>o;o+=1)c=s[o].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),c[2]?(r=parseFloat(c[2]),r/="%"===c[3]?100:e.width):r=o*d,i.colorStops.push({color:c[1],stop:r})}return i},o.Gradient=function(i,o){if(0!==o.width&&0!==o.height){var n,a,r=e.createElement("canvas"),s=r.getContext("2d");if(r.width=o.width,r.height=o.height,n=h.Generate.parseGradient(i,o))switch(n.type){case"linear":a=s.createLinearGradient(n.x0,n.y0,n.x1,n.y1),n.colorStops.forEach(t(a)),s.fillStyle=a,s.fillRect(0,0,o.width,o.height);break;case"circle":a=s.createRadialGradient(n.cx,n.cy,0,n.cx,n.cy,n.rx),n.colorStops.forEach(t(a)),s.fillStyle=a,s.fillRect(0,0,o.width,o.height);break;case"ellipse":var l=e.createElement("canvas"),d=l.getContext("2d"),c=Math.max(n.rx,n.ry),p=2*c;l.width=l.height=p,a=d.createRadialGradient(n.rx,n.ry,0,n.rx,n.ry,c),n.colorStops.forEach(t(a)),d.fillStyle=a,d.fillRect(0,0,p,p),s.fillStyle=n.colorStops[n.colorStops.length-1].color,s.fillRect(0,0,r.width,r.height),s.drawImage(l,n.cx-n.rx,n.cy-n.ry,2*n.rx,2*n.ry)}return r}},o.ListAlpha=function(t){var e,i="";do e=t%26,i=String.fromCharCode(e+64)+i,t/=26;while(26*t>26);return i},o.ListRoman=function(t){var e,i=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],o=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],n="",a=i.length;if(0>=t||t>=4e3)return t;for(e=0;a>e;e+=1)for(;t>=o[e];)t-=o[e],n+=i[e];return n}}(),h.Parse=function(o,n){function a(){return Math.max(Math.max(ct.body.scrollWidth,ct.documentElement.scrollWidth),Math.max(ct.body.offsetWidth,ct.documentElement.offsetWidth),Math.max(ct.body.clientWidth,ct.documentElement.clientWidth))}function r(){return Math.max(Math.max(ct.body.scrollHeight,ct.documentElement.scrollHeight),Math.max(ct.body.offsetHeight,ct.documentElement.offsetHeight),Math.max(ct.body.clientHeight,ct.documentElement.clientHeight))}function d(t,e){var i=parseInt(ft(t,e),10);return isNaN(i)?0:i}function c(t,e,i,o,n,a){"transparent"!==a&&(t.setVariable("fillStyle",a),t.fillRect(e,i,o,n),dt+=1)}function p(t,e,i){return t.length>0?e+i.toUpperCase():void 0}function u(t,e){switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,p);case"uppercase":return t.toUpperCase();default:return t}}function g(t){return/^(normal|none|0px)$/.test(t)}function f(t,e,i,o){null!==t&&ht.trimText(t).length>0&&(o.fillText(t,e,i),dt+=1)}function m(t,e,i,o){var n=!1,a=ft(e,"fontWeight"),r=ft(e,"fontFamily"),s=ft(e,"fontSize"),l=ht.parseTextShadows(ft(e,"textShadow"));switch(parseInt(a,10)){case 401:a="bold";break;case 400:a="normal"}return t.setVariable("fillStyle",o),t.setVariable("font",[ft(e,"fontStyle"),ft(e,"fontVariant"),a,s,r].join(" ")),t.setVariable("textAlign",n?"right":"left"),l.length&&(t.setVariable("shadowColor",l[0].color),t.setVariable("shadowOffsetX",l[0].offsetX),t.setVariable("shadowOffsetY",l[0].offsetY),t.setVariable("shadowBlur",l[0].blur)),"none"!==i?ht.Font(r,s,ct):void 0}function w(t,e,i,o,n){switch(e){case"underline":c(t,i.left,Math.round(i.top+o.baseline+o.lineWidth),i.width,1,n);break;case"overline":c(t,i.left,Math.round(i.top),i.width,1,n);break;case"line-through":c(t,i.left,Math.ceil(i.top+o.middle+o.lineWidth),i.width,1,n)}}function b(t,e,i,o,n){var a;if(pt.rangeBounds&&!n)("none"!==i||0!==ht.trimText(e).length)&&(a=y(e,t.node,t.textOffset)),t.textOffset+=e.length;else if(t.node&&"string"==typeof t.node.nodeValue){var r=o?t.node.splitText(e.length):null;a=v(t.node,n),t.node=r}return a}function y(t,e,i){var o=ct.createRange();return o.setStart(e,i),o.setEnd(e,i+t.length),o.getBoundingClientRect()}function v(t,e){var i=t.parentNode,o=ct.createElement("wrapper"),n=t.cloneNode(!0);o.appendChild(t.cloneNode(!0)),i.replaceChild(o,t);var a=e?ht.OffsetBounds(o):ht.Bounds(o);return i.replaceChild(n,o),a}function x(t,e,i){var o,a,r=i.ctx,s=ft(t,"color"),l=ft(t,"textDecoration"),d=ft(t,"textAlign"),c={node:e,textOffset:0};ht.trimText(e.nodeValue).length>0&&(e.nodeValue=u(e.nodeValue,ft(t,"textTransform")),d=d.replace(["-webkit-auto"],["auto"]),a=!n.letterRendering&&/^(left|right|justify|auto)$/.test(d)&&g(ft(t,"letterSpacing"))?e.nodeValue.split(/(\b| )/):e.nodeValue.split(""),o=m(r,t,l,s),n.chinese&&a.forEach(function(t,e){/.*[\u4E00-\u9FA5].*$/.test(t)&&(t=t.split(""),t.unshift(e,1),a.splice.apply(a,t))}),a.forEach(function(t,e){var n=b(c,t,l,e<a.length-1,i.transform.matrix);n&&(f(t,n.left,n.bottom,r),w(r,l,n,o,s))}))}function k(t,e){var i,o,n=ct.createElement("boundelement");return n.style.display="inline",i=t.style.listStyleType,t.style.listStyleType="none",n.appendChild(ct.createTextNode(e)),t.insertBefore(n,t.firstChild),o=ht.Bounds(n),t.removeChild(n),t.style.listStyleType=i,o}function C(t){var e=-1,i=1,o=t.parentNode.childNodes;if(t.parentNode){for(;o[++e]!==t;)1===o[e].nodeType&&i++;return i}return-1}function S(t,e){var i,o=C(t);switch(e){case"decimal":i=o;break;case"decimal-leading-zero":i=1===o.toString().length?o="0"+o.toString():o.toString();break;case"upper-roman":i=h.Generate.ListRoman(o);break;case"lower-roman":i=h.Generate.ListRoman(o).toLowerCase();break;case"lower-alpha":i=h.Generate.ListAlpha(o).toLowerCase();break;case"upper-alpha":i=h.Generate.ListAlpha(o)}return i+". "}function M(t,e,i){var o,n,a,r=e.ctx,s=ft(t,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(s)){if(n=S(t,s),a=k(t,n),m(r,t,"none",ft(t,"color")),"inside"!==ft(t,"listStylePosition"))return;r.setVariable("textAlign","left"),o=i.left,f(n,o,a.bottom,r)}}function L(t){var e=o[t];return e&&e.succeeded===!0?e.img:!1}function A(t,e){var i=Math.max(t.left,e.left),o=Math.max(t.top,e.top),n=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height);return{left:i,top:o,width:n-i,height:a-o}}function T(t,e,i){var o,n="static"!==e.cssPosition,a=n?ft(t,"zIndex"):"auto",r=ft(t,"opacity"),s="none"!==ft(t,"cssFloat");e.zIndex=o=l(a),o.isPositioned=n,o.isFloated=s,o.opacity=r,o.ownStacking="auto"!==a||1>r,i&&i.zIndex.children.push(e)}function O(t,e,i,o,n){var a=d(e,"paddingLeft"),r=d(e,"paddingTop"),s=d(e,"paddingRight"),l=d(e,"paddingBottom");j(t,i,0,0,i.width,i.height,o.left+a+n[3].width,o.top+r+n[0].width,o.width-(n[1].width+n[3].width+a+s),o.height-(n[0].width+n[2].width+r+l))}function R(t){return["Top","Right","Bottom","Left"].map(function(e){return{width:d(t,"border"+e+"Width"),color:ft(t,"border"+e+"Color")}})}function E(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){return ft(t,"border"+e+"Radius")})}function I(t,e,i,o){var n=function(t,e,i){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}};return{start:t,startControl:e,endControl:i,end:o,subdivide:function(a){var r=n(t,e,a),s=n(e,i,a),l=n(i,o,a),d=n(r,s,a),c=n(s,l,a),h=n(d,c,a);return[I(t,r,d,h),I(h,c,l,o)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,i.x,i.y,o.x,o.y])},curveToReversed:function(o){o.push(["bezierCurve",i.x,i.y,e.x,e.y,t.x,t.y])}}}function B(t,e,i,o,n,a,r){e[0]>0||e[1]>0?(t.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(t),o[1].curveTo(t)):t.push(["line",a,r]),(i[0]>0||i[1]>0)&&t.push(["line",n[0].start.x,n[0].start.y])}function F(t,e,i,o,n,a,r){var s=[];return e[0]>0||e[1]>0?(s.push(["line",o[1].start.x,o[1].start.y]),o[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),i[0]>0||i[1]>0?(s.push(["line",a[0].start.x,a[0].start.y]),a[0].curveTo(s),s.push(["line",r[0].end.x,r[0].end.y]),r[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",n[1].end.x,n[1].end.y]),n[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function P(t,e,i){var o=t.left,n=t.top,a=t.width,r=t.height,s=e[0][0],l=e[0][1],d=e[1][0],c=e[1][1],h=e[2][0],p=e[2][1],u=e[3][0],g=e[3][1],f=a-d,m=r-p,w=a-h,b=r-g;return{topLeftOuter:bt(o,n,s,l).topLeft.subdivide(.5),topLeftInner:bt(o+i[3].width,n+i[0].width,Math.max(0,s-i[3].width),Math.max(0,l-i[0].width)).topLeft.subdivide(.5),topRightOuter:bt(o+f,n,d,c).topRight.subdivide(.5),topRightInner:bt(o+Math.min(f,a+i[3].width),n+i[0].width,f>a+i[3].width?0:d-i[3].width,c-i[0].width).topRight.subdivide(.5),bottomRightOuter:bt(o+w,n+m,h,p).bottomRight.subdivide(.5),bottomRightInner:bt(o+Math.min(w,a+i[3].width),n+Math.min(m,r+i[0].width),Math.max(0,h-i[1].width),Math.max(0,p-i[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:bt(o,n+b,u,g).bottomLeft.subdivide(.5),bottomLeftInner:bt(o+i[3].width,n+b,Math.max(0,u-i[3].width),Math.max(0,g-i[2].width)).bottomLeft.subdivide(.5)}}function z(t,e,i,o,n){var a=ft(t,"backgroundClip"),r=[];switch(a){case"content-box":case"padding-box":B(r,o[0],o[1],e.topLeftInner,e.topRightInner,n.left+i[3].width,n.top+i[0].width),B(r,o[1],o[2],e.topRightInner,e.bottomRightInner,n.left+n.width-i[1].width,n.top+i[0].width),B(r,o[2],o[3],e.bottomRightInner,e.bottomLeftInner,n.left+n.width-i[1].width,n.top+n.height-i[2].width),B(r,o[3],o[0],e.bottomLeftInner,e.topLeftInner,n.left+i[3].width,n.top+n.height-i[2].width);break;default:B(r,o[0],o[1],e.topLeftOuter,e.topRightOuter,n.left,n.top),B(r,o[1],o[2],e.topRightOuter,e.bottomRightOuter,n.left+n.width,n.top),B(r,o[2],o[3],e.bottomRightOuter,e.bottomLeftOuter,n.left+n.width,n.top+n.height),B(r,o[3],o[0],e.bottomLeftOuter,e.topLeftOuter,n.left,n.top+n.height)}return r}function D(t,e,i){var o,n,a,r,s,l,d=e.left,c=e.top,h=e.width,p=e.height,u=E(t),g=P(e,u,i),f={clip:z(t,g,i,u,e),borders:[]};for(o=0;4>o;o++)if(i[o].width>0){switch(n=d,a=c,r=h,s=p-i[2].width,o){case 0:s=i[0].width,l=F({c1:[n,a],c2:[n+r,a],c3:[n+r-i[1].width,a+s],c4:[n+i[3].width,a+s]},u[0],u[1],g.topLeftOuter,g.topLeftInner,g.topRightOuter,g.topRightInner);break;case 1:n=d+h-i[1].width,r=i[1].width,l=F({c1:[n+r,a],c2:[n+r,a+s+i[2].width],c3:[n,a+s],c4:[n,a+i[0].width]},u[1],u[2],g.topRightOuter,g.topRightInner,g.bottomRightOuter,g.bottomRightInner);break;case 2:a=a+p-i[2].width,s=i[2].width,l=F({c1:[n+r,a+s],c2:[n,a+s],c3:[n+i[3].width,a],c4:[n+r-i[3].width,a]},u[2],u[3],g.bottomRightOuter,g.bottomRightInner,g.bottomLeftOuter,g.bottomLeftInner);break;case 3:r=i[3].width,l=F({c1:[n,a+s+i[2].width],c2:[n,a],c3:[n+r,a+i[0].width],c4:[n+r,a+s]},u[3],u[0],g.bottomLeftOuter,g.bottomLeftInner,g.topLeftOuter,g.topLeftInner)}f.borders.push({args:l,color:i[o].color})}return f}function U(t,e){var i=t.drawShape();return e.forEach(function(t,e){i[0===e?"moveTo":t[0]+"To"].apply(null,t.slice(1))}),i}function N(t,e,i){"transparent"!==i&&(t.setVariable("fillStyle",i),U(t,e),t.fill(),dt+=1)}function _(t,e,i){var o,n,a=ct.createElement("valuewrap"),r=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];r.forEach(function(e){try{a.style[e]=ft(t,e)}catch(i){ht.log("html2canvas: Parse: Exception caught in renderFormValue: "+i.message)}}),a.style.borderColor="black",a.style.borderStyle="solid",a.style.display="block",a.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(t.type)||"SELECT"===t.nodeName)&&(a.style.lineHeight=ft(t,"height")),a.style.top=e.top+"px",a.style.left=e.left+"px",o="SELECT"===t.nodeName?(t.options[t.selectedIndex]||0).text:t.value,o||(o=t.placeholder),n=ct.createTextNode(o),a.appendChild(n),gt.appendChild(a),x(t,n,i),gt.removeChild(a)}function j(t){t.drawImage.apply(t,Array.prototype.slice.call(arguments,1)),dt+=1}function G(i,o){var n=t.getComputedStyle(i,o);if(n&&n.content&&"none"!==n.content&&"-moz-alt-content"!==n.content&&"none"!==n.display){var a=n.content+"",r=a.substr(0,1);r===a.substr(a.length-1)&&r.match(/'|"/)&&(a=a.substr(1,a.length-2));var s="url"===a.substr(0,3),l=e.createElement(s?"img":"span");return l.className=mt+"-before "+mt+"-after",Object.keys(n).filter(W).forEach(function(t){try{l.style[t]=n[t]}catch(e){ht.log(["Tried to assign readonly property ",t,"Error:",e])}}),s?l.src=ht.parseBackgroundImage(a)[0].args[0]:l.innerHTML=a,l}}function W(e){return isNaN(t.parseInt(e,10))}function H(t,e){var i=G(t,":before"),o=G(t,":after");(i||o)&&(i&&(t.className+=" "+mt+"-before",t.parentNode.insertBefore(i,t),at(i,e,!0),t.parentNode.removeChild(i),t.className=t.className.replace(mt+"-before","").trim()),o&&(t.className+=" "+mt+"-after",t.appendChild(o),at(o,e,!0),t.removeChild(o),t.className=t.className.replace(mt+"-after","").trim()))}function V(t,e,i,o){var n=Math.round(o.left+i.left),a=Math.round(o.top+i.top);t.createPattern(e),t.translate(n,a),t.fill(),t.translate(-n,-a)}function Y(t,e,i,o,n,a,r,s){var l=[];l.push(["line",Math.round(n),Math.round(a)]),l.push(["line",Math.round(n+r),Math.round(a)]),l.push(["line",Math.round(n+r),Math.round(s+a)]),l.push(["line",Math.round(n),Math.round(s+a)]),U(t,l),t.save(),t.clip(),V(t,e,i,o),t.restore()}function Z(t,e,i){c(t,e.left,e.top,e.width,e.height,i)}function q(t,e,i,o,n){var a=ht.BackgroundSize(t,e,o,n),r=ht.BackgroundPosition(t,e,o,n,a),s=ft(t,"backgroundRepeat").split(",").map(ht.trimText);switch(o=J(o,a),s=s[n]||s[0]){case"repeat-x":Y(i,o,r,e,e.left,e.top+r.top,99999,o.height);break;case"repeat-y":Y(i,o,r,e,e.left+r.left,e.top,o.width,99999);break;case"no-repeat":Y(i,o,r,e,e.left+r.left,e.top+r.top,o.width,o.height);break;default:V(i,o,r,{top:e.top,left:e.left,width:o.width,height:o.height})}}function X(t,e,i){for(var o,n=ft(t,"backgroundImage"),a=ht.parseBackgroundImage(n),r=a.length;r--;)if(n=a[r],n.args&&0!==n.args.length){var s="url"===n.method?n.args[0]:n.value;o=L(s),o?q(t,e,i,o,r):ht.log("html2canvas: Error loading background:",n)}}function J(t,e){if(t.width===e.width&&t.height===e.height)return t;var i,o=ct.createElement("canvas");return o.width=e.width,o.height=e.height,i=o.getContext("2d"),j(i,t,0,0,t.width,t.height,0,0,e.width,e.height),o}function Q(t,e,i){return t.setVariable("globalAlpha",ft(e,"opacity")*(i?i.opacity:1))}function K(t){return t.replace("px","")}function $(t,e){var i=ft(t,"transform")||ft(t,"-webkit-transform")||ft(t,"-moz-transform")||ft(t,"-ms-transform")||ft(t,"-o-transform"),o=ft(t,"transform-origin")||ft(t,"-webkit-transform-origin")||ft(t,"-moz-transform-origin")||ft(t,"-ms-transform-origin")||ft(t,"-o-transform-origin")||"0px 0px";o=o.split(" ").map(K).map(ht.asFloat);var n;if(i&&"none"!==i){var a=i.match(yt);if(a)switch(a[1]){case"matrix":n=a[2].split(",").map(ht.trimText).map(ht.asFloat)}}return{origin:o,matrix:n}}function tt(t,e,i,o){var l=s(e?i.width:a(),e?i.height:r()),d={ctx:l,opacity:Q(l,t,e),cssPosition:ft(t,"position"),borders:R(t),transform:o,clip:e&&e.clip?ht.Extend({},e.clip):null};return T(t,d,e),n.useOverflow===!0&&/(hidden|scroll|auto)/.test(ft(t,"overflow"))===!0&&/(BODY)/i.test(t.nodeName)===!1&&(d.clip=d.clip?A(d.clip,i):i),d}function et(t,e,i){var o={left:e.left+t[3].width,top:e.top+t[0].width,width:e.width-(t[1].width+t[3].width),height:e.height-(t[0].width+t[2].width)};return i&&(o=A(o,i)),o}function it(t,e){var i=e.matrix?ht.OffsetBounds(t):ht.Bounds(t);return e.origin[0]+=i.left,e.origin[1]+=i.top,i}function ot(t,e,i,o){var n,a=$(t,e),r=it(t,a),s=tt(t,e,r,a),l=s.borders,d=s.ctx,c=et(l,r,s.clip),h=D(t,r,l),p=ut.test(t.nodeName)?"#efefef":ft(t,"backgroundColor");switch(U(d,h.clip),d.save(),d.clip(),c.height>0&&c.width>0&&!o?(Z(d,r,p),X(t,c,d)):o&&(s.backgroundColor=p),d.restore(),h.borders.forEach(function(t){N(d,t.args,t.color)}),i||H(t,s),t.nodeName){case"IMG":(n=L(t.getAttribute("src")))?O(d,t,n,r,l):ht.log("html2canvas: Error loading <img>:"+t.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(t.type)&&(t.value||t.placeholder||"").length>0&&_(t,r,s);break;case"TEXTAREA":(t.value||t.placeholder||"").length>0&&_(t,r,s);break;case"SELECT":(t.options||t.placeholder||"").length>0&&_(t,r,s);break;case"LI":M(t,s,c);break;case"CANVAS":O(d,t,t,r,l)}return s}function nt(t){return"none"!==ft(t,"display")&&"hidden"!==ft(t,"visibility")&&!t.hasAttribute("data-html2canvas-ignore")}function at(t,e,i){nt(t)&&(e=ot(t,e,i,!1)||e,ut.test(t.nodeName)||rt(t,e,i))}function rt(t,e,i){ht.Children(t).forEach(function(o){o.nodeType===o.ELEMENT_NODE?at(o,e,i):o.nodeType===o.TEXT_NODE&&x(t,o,e)})}function st(){var t=ft(e.documentElement,"backgroundColor"),i=ht.isTransparent(t)&&lt===e.body,o=ot(lt,null,!1,i);return rt(lt,o),i&&(t=o.backgroundColor),gt.removeChild(wt),{backgroundColor:t,stack:o}}t.scroll(0,0);var lt=n.elements===i?e.body:n.elements[0],dt=0,ct=lt.ownerDocument,ht=h.Util,pt=ht.Support(n,ct),ut=new RegExp("("+n.ignoreElements+")"),gt=ct.body,ft=ht.getCSS,mt="___html2canvas___pseudoelement",wt=ct.createElement("style");wt.innerHTML="."+mt+'-before:before { content: "" !important; display: none !important; }.'+mt+'-after:after { content: "" !important; display: none !important; }',gt.appendChild(wt),o=o||{};var bt=function(t){return function(e,i,o,n){var a=o*t,r=n*t,s=e+o,l=i+n;return{topLeft:I({x:e,y:l},{x:e,y:l-r},{x:s-a,y:i},{x:s,y:i}),topRight:I({x:e,y:i},{x:e+a,y:i},{x:s,y:l-r},{x:s,y:l}),bottomRight:I({x:s,y:i},{x:s,y:i+r},{x:e+a,y:l},{x:e,y:l}),bottomLeft:I({x:s,y:l},{x:s-a,y:l},{x:e,y:i+r},{x:e,y:i})}}}(4*((Math.sqrt(2)-1)/3)),yt=/(matrix)\((.+)\)/;return st()},h.Preload=function(o){function n(t){L.href=t,L.href=L.href;var e=L.protocol+L.host;return e===f}function a(){v.log("html2canvas: start: images: "+y.numLoaded+" / "+y.numTotal+" (failed: "+y.numFailed+")"),!y.firstRun&&y.numLoaded>=y.numTotal&&(v.log("Finished loading images: # "+y.numTotal+" (failed: "+y.numFailed+")"),"function"==typeof o.complete&&o.complete(y))}function r(e,n,r){var s,l,d=o.proxy;L.href=e,e=L.href,s="html2canvas_"+x++,r.callbackname=s,d+=d.indexOf("?")>-1?"&":"?",d+="url="+encodeURIComponent(e)+"&callback="+s,l=C.createElement("script"),t[s]=function(e){"error:"===e.substring(0,6)?(r.succeeded=!1,y.numLoaded++,y.numFailed++,a()):(g(n,r),n.src=e),t[s]=i;try{delete t[s]}catch(o){}l.parentNode.removeChild(l),l=null,delete r.script,delete r.callbackname},l.setAttribute("type","text/javascript"),l.setAttribute("src",d),r.script=l,t.document.body.appendChild(l)}function s(e,i){var o=t.getComputedStyle(e,i),n=o.content;"url"===n.substr(0,3)&&m.loadImage(h.Util.parseBackgroundImage(n)[0].args[0]),p(o.backgroundImage,e)}function l(t){s(t,":before"),s(t,":after")}function d(t,e){var o=h.Generate.Gradient(t,e);o!==i&&(y[t]={img:o,succeeded:!0},y.numTotal++,y.numLoaded++,a())}function c(t){return t&&t.method&&t.args&&t.args.length>0}function p(t,e){var o;h.Util.parseBackgroundImage(t).filter(c).forEach(function(t){"url"===t.method?m.loadImage(t.args[0]):t.method.match(/\-?gradient$/)&&(o===i&&(o=h.Util.Bounds(e)),d(t.value,o))})}function u(t){var e=!1;try{v.Children(t).forEach(u)}catch(o){}try{e=t.nodeType}catch(n){e=!1,v.log("html2canvas: failed to access some element's nodeType - Exception: "+n.message)}if(1===e||e===i){l(t);try{p(v.getCSS(t,"backgroundImage"),t)}catch(o){v.log("html2canvas: failed to get background-image - Exception: "+o.message)}p(t)}}function g(e,n){e.onload=function(){n.timer!==i&&t.clearTimeout(n.timer),y.numLoaded++,n.succeeded=!0,e.onerror=e.onload=null,a()},e.onerror=function(){if("anonymous"===e.crossOrigin&&(t.clearTimeout(n.timer),o.proxy)){var i=e.src;return e=new Image,n.img=e,e.src=i,void r(e.src,e,n)}y.numLoaded++,y.numFailed++,n.succeeded=!1,e.onerror=e.onload=null,a()}}var f,m,w,b,y={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},v=h.Util,x=0,k=o.elements[0]||e.body,C=k.ownerDocument,S=k.getElementsByTagName("img"),M=S.length,L=C.createElement("a"),A=function(t){return t.crossOrigin!==i}(new Image);for(L.href=t.location.href,f=L.protocol+L.host,m={loadImage:function(t){var e,a;t&&y[t]===i&&(e=new Image,t.match(/data:image\/.*;base64,/i)?(e.src=t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),a=y[t]={img:e},y.numTotal++,g(e,a)):n(t)||o.allowTaint===!0?(a=y[t]={img:e},y.numTotal++,g(e,a),e.src=t):A&&!o.allowTaint&&o.useCORS?(e.crossOrigin="anonymous",a=y[t]={img:e},y.numTotal++,g(e,a),e.src=t):o.proxy&&(a=y[t]={img:e},y.numTotal++,r(t,e,a)))},cleanupDOM:function(n){var r,s;if(!y.cleanupDone){n&&"string"==typeof n?v.log("html2canvas: Cleanup because: "+n):v.log("html2canvas: Cleanup after timeout: "+o.timeout+" ms.");for(s in y)if(y.hasOwnProperty(s)&&(r=y[s],"object"==typeof r&&r.callbackname&&r.succeeded===i)){
t[r.callbackname]=i;try{delete t[r.callbackname]}catch(l){}r.script&&r.script.parentNode&&(r.script.setAttribute("src","about:blank"),r.script.parentNode.removeChild(r.script)),y.numLoaded++,y.numFailed++,v.log("html2canvas: Cleaned up failed img: '"+s+"' Steps: "+y.numLoaded+" / "+y.numTotal)}t.stop!==i?t.stop():e.execCommand!==i&&e.execCommand("Stop",!1),e.close!==i&&e.close(),y.cleanupDone=!0,n&&"string"==typeof n||a()}},renderingDone:function(){b&&t.clearTimeout(b)}},o.timeout>0&&(b=t.setTimeout(m.cleanupDOM,o.timeout)),v.log("html2canvas: Preload starts: finding background-images"),y.firstRun=!0,u(k),v.log("html2canvas: Preload: Finding images"),w=0;M>w;w+=1)m.loadImage(S[w].getAttribute("src"));return y.firstRun=!1,v.log("html2canvas: Preload: Done."),y.numTotal===y.numLoaded&&a(),m},h.Renderer=function(t,o){function n(t){function e(t){Object.keys(t).sort().forEach(function(i){var o=[],a=[],r=[],s=[];t[i].forEach(function(t){t.node.zIndex.isPositioned||t.node.zIndex.opacity<1?r.push(t):t.node.zIndex.isFloated?a.push(t):o.push(t)}),function l(t){t.forEach(function(t){s.push(t),t.children&&l(t.children)})}(o.concat(a,r)),s.forEach(function(t){t.context?e(t.context):n.push(t.node)})})}var o,n=[];return o=function(t){function e(t,o,n){var a="auto"===o.zIndex.zindex?0:Number(o.zIndex.zindex),r=t,s=o.zIndex.isPositioned,l=o.zIndex.isFloated,d={node:o},c=n;o.zIndex.ownStacking?(r=d.context={"!":[{node:o,children:[]}]},c=i):(s||l)&&(c=d.children=[]),0===a&&n?n.push(d):(t[a]||(t[a]=[]),t[a].push(d)),o.zIndex.children.forEach(function(t){e(r,t,c)})}var o={};return e(o,t),o}(t),e(o),n}function a(t){var e;if("string"==typeof o.renderer&&h.Renderer[t]!==i)e=h.Renderer[t](o);else{if("function"!=typeof t)throw new Error("Unknown renderer");e=t(o)}if("function"!=typeof e)throw new Error("Invalid renderer defined");return e}return a(o.renderer)(t,o,e,n(t.stack),h)},h.Util.Support=function(t,e){function o(){var t=new Image,o=e.createElement("canvas"),n=o.getContext===i?!1:o.getContext("2d");if(n===!1)return!1;o.width=o.height=10,t.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{n.drawImage(t,0,0),o.toDataURL()}catch(a){return!1}return h.Util.log("html2canvas: Parse: SVG powered rendering available"),!0}function n(){var t,i,o,n,a=!1;return e.createRange&&(t=e.createRange(),t.getBoundingClientRect&&(i=e.createElement("boundtest"),i.style.height="123px",i.style.display="block",e.body.appendChild(i),t.selectNode(i),o=t.getBoundingClientRect(),n=o.height,123===n&&(a=!0),e.body.removeChild(i))),a}return{rangeBounds:n(),svgRendering:t.svgRendering&&o()}},t.html2canvas=function(e,i){e=e.length?e:[e];var o,n,a={logging:!1,elements:e,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return a=h.Util.Extend(i,a),h.logging=a.logging,a.complete=function(t){("function"!=typeof a.onpreloaded||a.onpreloaded(t)!==!1)&&(o=h.Parse(t,a),("function"!=typeof a.onparsed||a.onparsed(o)!==!1)&&(n=h.Renderer(o,a),"function"==typeof a.onrendered&&a.onrendered(n)))},t.setTimeout(function(){h.Preload(a)},0),{render:function(t,e){return h.Renderer(t,h.Util.Extend(e,a))},parse:function(t,e){return h.Parse(t,h.Util.Extend(e,a))},preload:function(t){return h.Preload(h.Util.Extend(t,a))},log:h.Util.log}},t.html2canvas.log=h.Util.log,t.html2canvas.Renderer={Canvas:i},h.Renderer.Canvas=function(t){function o(t,e){t.beginPath(),e.forEach(function(e){t[e.name].apply(t,e.arguments)}),t.closePath()}function n(t){if(-1===s.indexOf(t.arguments[0].src)){d.drawImage(t.arguments[0],0,0);try{d.getImageData(0,0,1,1)}catch(e){return l=r.createElement("canvas"),d=l.getContext("2d"),!1}s.push(t.arguments[0].src)}return!0}function a(e,i){switch(i.type){case"variable":e[i.name]=i.arguments;break;case"function":switch(i.name){case"createPattern":if(i.arguments[0].width>0&&i.arguments[0].height>0)try{e.fillStyle=e.createPattern(i.arguments[0],"repeat")}catch(a){c.log("html2canvas: Renderer: Error creating pattern",a.message)}break;case"drawShape":o(e,i.arguments);break;case"drawImage":i.arguments[8]>0&&i.arguments[7]>0&&(!t.taintTest||t.taintTest&&n(i))&&e.drawImage.apply(e,i.arguments);break;default:e[i.name].apply(e,i.arguments)}}}t=t||{};var r=e,s=[],l=e.createElement("canvas"),d=l.getContext("2d"),c=h.Util,p=t.canvas||r.createElement("canvas");return function(t,e,o,n,r){var s,l,d,h=p.getContext("2d"),u=t.stack;return p.width=p.style.width=e.width||u.ctx.width,p.height=p.style.height=e.height||u.ctx.height,d=h.fillStyle,h.fillStyle=c.isTransparent(u.backgroundColor)&&e.background!==i?e.background:t.backgroundColor,h.fillRect(0,0,p.width,p.height),h.fillStyle=d,n.forEach(function(t){h.textBaseline="bottom",h.save(),t.transform.matrix&&(h.translate(t.transform.origin[0],t.transform.origin[1]),h.transform.apply(h,t.transform.matrix),h.translate(-t.transform.origin[0],-t.transform.origin[1])),t.clip&&(h.beginPath(),h.rect(t.clip.left,t.clip.top,t.clip.width,t.clip.height),h.clip()),t.ctx.storage&&t.ctx.storage.forEach(function(t){a(h,t)}),h.restore()}),c.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),1===e.elements.length&&"object"==typeof e.elements[0]&&"BODY"!==e.elements[0].nodeName?(l=r.Util.Bounds(e.elements[0]),s=o.createElement("canvas"),s.width=Math.ceil(l.width),s.height=Math.ceil(l.height),h=s.getContext("2d"),h.drawImage(p,l.left,l.top,l.width,l.height,0,0,l.width,l.height),p=null,s):p}}}(window,document),o("undefined"!=typeof html2canvas?html2canvas:window.html2canvas)}).call(t,void 0,void 0,void 0,function(t){e.exports=t})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e,i){var o=t("leaflet"),n=o.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:""},initialize:function(t,e){o.Util.setOptions(this,e),this._key=t,this._url=null,this._providers=[],this.metaRequested=!1},tile2quad:function(t,e,i){for(var o="",n=i;n>0;n--){var a=0,r=1<<n-1;0!==(t&r)&&(a+=1),0!==(e&r)&&(a+=2),o+=a}return o},getTileUrl:function(t){var e=this._getZoomForUrl(),i=this.options.subdomains,o=this.options.subdomains[Math.abs((t.x+t.y)%i.length)];return this._url.replace("{subdomain}",o).replace("{quadkey}",this.tile2quad(t.x,t.y,e)).replace("{culture}",this.options.culture)},loadMetadata:function(){if(!this.metaRequested){this.metaRequested=!0;var t=this,e="_bing_metadata_"+o.Util.stamp(this);window[e]=function(i){window[e]=void 0;var o=document.getElementById(e);if(o.parentNode.removeChild(o),i.errorDetails)throw new Error(i.errorDetails);t.initMetadata(i)};var i="file:"===document.location.protocol?"http":document.location.protocol.slice(0,-1),n=i+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+e+"&key="+this._key+"&UriScheme="+i,a=document.createElement("script");a.type="text/javascript",a.src=n,a.id=e,document.getElementsByTagName("head")[0].appendChild(a)}},initMetadata:function(t){var e=t.resourceSets[0].resources[0];if(this.options.subdomains=e.imageUrlSubdomains,this._url=e.imageUrl,e.imageryProviders)for(var i=0;i<e.imageryProviders.length;i++)for(var n=e.imageryProviders[i],a=0;a<n.coverageAreas.length;a++){var r=n.coverageAreas[a],s={zoomMin:r.zoomMin,zoomMax:r.zoomMax,active:!1},l=new o.LatLngBounds(new o.LatLng(r.bbox[0]+.01,r.bbox[1]+.01),new o.LatLng(r.bbox[2]-.01,r.bbox[3]-.01));s.bounds=l,s.attrib=n.attribution,this._providers.push(s)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),o.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var t=o.latLngBounds(this._map.getBounds().getSouthWest().wrap(),this._map.getBounds().getNorthEast().wrap()),e=this._map.getZoom(),i=0;i<this._providers.length;i++){var n=this._providers[i];e<=n.zoomMax&&e>=n.zoomMin&&t.intersects(n.bounds)?(!n.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(n.attrib),n.active=!0):(n.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(n.attrib),n.active=!1)}},onAdd:function(t){this.loadMetadata(),o.TileLayer.prototype.onAdd.apply(this,[t])},onRemove:function(t){for(var e=0;e<this._providers.length;e++){var i=this._providers[e];i.active&&this._map.attributionControl&&(this._map.attributionControl.removeAttribution(i.attrib),i.active=!1)}o.TileLayer.prototype.onRemove.apply(this,[t])}}),a=function(t,e){return new n(t,e)};e.exports={BingLayer:n,bingLayer:a}},{}],4:[function(e,i,o){!function(o,n){"use strict";if("undefined"!=typeof i&&i.exports&&"function"==typeof e)n(e("ractive"));else if("function"==typeof t&&t.amd)t(["ractive"],n);else{if(!o.Ractive)throw new Error("Could not find Ractive! It must be loaded before the ractive-transitions-slide plugin");n(o.Ractive)}}("undefined"!=typeof window?window:this,function(t){"use strict";var e,i,o,n;n={duration:300,easing:"easeInOut"},i=["height","borderTopWidth","borderBottomWidth","paddingTop","paddingBottom","marginTop","marginBottom"],o={height:0,borderTopWidth:0,borderBottomWidth:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0},e=function(t,e){var a;e=t.processParams(e,n),t.isIntro?(a=t.getStyle(i),t.setStyle(o)):(t.setStyle(t.getStyle(i)),a=o),t.setStyle("overflowY","hidden"),t.animateStyle(a,e).then(t.complete)},t.transitions.slide=e})},{}],5:[function(t,e,i){"use strict";var o=t("leaflet");o.BingLayer=t("../libs/leaflet-plugins.bing.js").BingLayer;var n=t("../libs/html2canvas.js"),a=t("lodash"),r=t("ractive"),s=t("ractive-events-tap");t("../libs/ractive-transitions-slide.js"),t("leaflet-draw"),t("leaflet-minimap");var l=t("./js/utils.js"),d=t("./js/dom.js"),c=t("./js/geocode.js"),h=function(t){this.options=a.extend({template:' <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">  <div class="locator {{ (noGenerate.controlsOpen) ? \'controls-open\' : \'controls-closed\' }} {{ options.superClass }}">  <section class="locator-display">  <div class="locator-map-wrapper">  <div class="locator-display-inner">  <div class="locator-map">  <div class="locator-map-attribution {{#options.embedAttribution}}enabled{{/}}">  {{#options.overrideAttribution}}  {{{ options.overrideAttribution }}}  {{/}}  {{^options.overrideAttribution}}  {{{ options.tilesets[options.tileset].attribution }}}  {{/}}  </div>  </div>   <div class="locator-map-help">  Move the marker by dragging the base.   {{#options.drawing}}  Use the buttons to draw shapes on the map.  {{/drawing}}   {{#(options.tilesets[options.tileset] && options.tilesets[options.tileset].attribution)}}  Required attribution for this map: <br>  <span class="attribution">{{{ options.tilesets[options.tileset].attribution }}}</span>  {{/()}}  </div>  </div>  </div>  </section>    <section class="locator-controls">  <div class="minor-controls">  <div class="toggle-controls" on-tap="toggle:\'noGenerate.controlsOpen\'" title="{{#noGenerate.controlsOpen}}Hide controls and preview{{ else }}Show controls{{/noGenerate.controlsOpen}}"></div>   <button class="minor-button minor-generate" on-tap="generate" title="Generate"><i class="fa fa-download"></i></button>  </div>   <div class="locator-controls-wrapper">  <header>{{{ options.title }}}</header>   <div class="locator-input">  <div class="locator-history">  <button class="small inline action undo" disabled="{{ !canUndo }}" title="Undo" on-tap="undo"><i class="fa fa-rotate-left"></i></button>  <button class="small inline action redo" disabled="{{ !canRedo }}" title="Redo" on-tap="redo"><i class="fa fa-rotate-right"></i></button>  <button class="small inline destructive reset" title="Reset all options" on-tap="resetOptions"><i class="fa fa-refresh"></i></button>  </div>   {{^options.geocoder}}  <div class="config-option">  <label>Latitude and longitude location</label>   <br><input type="number" placeholder="Latitude" value="{{ options.lat }}" lazy>  <br><input type="number" placeholder="Longitude" value="{{ options.lng }}" lazy>  </div>  {{/options.geocoder}}   {{#options.geocoder}}  <div class="config-option">  <label>Search</label>  <input type="text" placeholder="Address or lat,lng" value="{{ geocodeInput }}" lazy disabled="{{ isGeocoding }}">  </div>  {{/options.geocoder}}   <div class="markers {{^options.markers}}no-markers{{/}}">  <label class="no-markers-label">Markers</label>  <button class="add-marker action small inline" on-tap="add-marker" title="Add marker at center of map"><i class="fa fa-plus"></i></button>   <label class="markers-label">Markers</label>  <div class="help">Use <code>&lt;br&gt;</code> to make line breaks.</div>   {{#options.markers:mi}}  <div class="marker" intro-outro="slide">  <div class="config-option">  <input type="text" placeholder="Marker label" value="{{ this.text }}" lazy>  </div>   <div class="marker-actions">  {{#options.markerToCenter}}  <button class="action small" on-tap="marker-to-center:{{ mi }}" title="Move marker to center of map"><i class="fa fa-compass"></i></button>  {{/}}   {{#options.centerToMarker}}  <button class="action small" on-tap="center-to-marker:{{ mi }}" title="Center map on marker"><i class="fa fa-plus-square-o"></i></button>  {{/}}   {{#(_.size(options.markerBackgrounds) > 1)}}  <div class="color-picker" title="Set marker background color">  {{#options.markerBackgrounds:bi}}  <div class="color-picker-item {{#(options.markers[mi] && options.markers[mi].background === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setMarker:{{ mi }},\'background\',{{ this }}">  {{/}}  </div>  {{/}}   {{#(_.size(options.markerForegrounds) > 1)}}  <div class="color-picker" title="Set marker foreground color">  {{#options.markerForegrounds:bi}}  <div class="color-picker-item {{#(options.markers[mi] && options.markers[mi].foreground === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setMarker:{{ mi }},\'foreground\',{{ this }}">  {{/}}  </div>  {{/}}   <button class="destructive small" on-tap="remove-marker:{{ mi }}" title="Remove marker"><i class="fa fa-close"></i></button>  </div>  </div>  {{/}}  </div>   {{#options.drawing}}  <div class="drawing">  <label class="markers-label">Shapes</label>  <div class="help">Use the buttons on the map to draw shapes.</div>   <div class="drawing-section">  <div class="drawing-option">  <input type="checkbox" checked="{{ options.drawingStyles.stroke }}" id="drawing-styles-stroke" lazy>  <label for="drawing-styles-stroke">Stroke</label>  </div>   {{#(_.size(options.drawingStrokes) > 1 && options.drawingStyles.stroke)}}  <div class="color-picker" title="Set drawing stroke color">  {{#options.drawingStrokes:di}}  <div class="color-picker-item {{#(options.drawingStyles.color === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setDrawing:\'color\',{{ this }}">  {{/}}  </div>  {{/}}  </div>   <div class="drawing-section">  <div class="drawing-option">  <input type="checkbox" checked="{{ options.drawingStyles.fill }}" id="drawing-styles-fill" lazy>  <label for="drawing-styles-fill">Fill</label>  </div>   {{#(_.size(options.drawingStrokes) > 1 && options.drawingStyles.fill)}}  <div class="color-picker" title="Set drawing fill color">  {{#options.drawingFills:di}}  <div class="color-picker-item {{#(options.drawingStyles.fillColor === this)}}active{{ else }}inactive{{/()}} {{#(this.indexOf(\'255, 255, 255\') !== -1 || this.indexOf(\'FFFFFF\') !== -1)}}is-white{{/()}}"  style="background-color: {{ this }}"  on-tap="setDrawing:\'fillColor\',{{ this }}">  {{/}}  </div>  {{/}}  </div>  </div>  {{/options.drawing}}   {{#(_.size(options.tilesets) > 1)}}  <div class="config-option">  <label>Background</label>   <div class="image-picker images-{{ _.size(options.tilesets) }}">  {{#options.tilesets:i}}  <div class="image-picker-item {{ (options.tileset === i) ? \'active\' : \'inactive\' }}" style="background-image: url({{= preview }});" title="{{ i }}" on-tap="set:\'options.tileset\',{{ i }}"></div>  {{/options.tilesets}}  </div>  </div>  {{/()}}   {{#(_.size(options.widths) > 1)}}  <div class="config-option config-select">  <label>Map width</label>   <select value="{{ options.width }}">  {{#options.widths:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.widths}}  </select>  </div>  {{/()}}   {{#(_.size(options.ratios) > 1)}}  <div class="config-option config-select">  <label>Map aspect ratio</label>   <select value="{{ options.ratio }}">  {{#options.ratios:i}}  <option value="{{ i }}">{{ i }}</option>  {{/options.ratios}}  </select>  </div>  {{/()}}   {{#options.miniControl}}  <div class="config-option">  <input type="checkbox" checked="{{ options.mini }}" id="config-mini" lazy>  <label for="config-mini">Mini-map</label>   {{#options.mini}}  <label>Mini-map zoom level</label>  <input type="range" min="-20" max="1" value="{{ options.miniZoomOffset }}" title="Adjust zoom level for map">  {{/options.mini}}  </div>  {{/options.miniControl}}   <div class="config-option">  <input type="checkbox" checked="{{ options.embedAttribution }}" id="config-embed-attribution" lazy>  <label for="config-embed-attribution">Embed attribution</label>   <input type="text" placeholder="Override attribution" value="{{ options.overrideAttribution }}" lazy>  </div>   <div class="config-action">  <button class="large additive generate-image" on-tap="generate">Generate <i class="fa fa-download"></i></button>  </div>   <div class="preview">  <h1>Preview</h1>  <img src="" /><br>  <a href="" class="download-link">Download</a>  </div>  </div>   <footer>  {{{ options.footer }}}  </footer>  </div>  </section> </div> ',title:"Locator demo",footer:'Made by the <a href="//datanews.tumblr.com/" target="_blank">WNYC DataNews</a> team.  Locator only works in <a href="//google.com/chrome" target="_blank">Google Chrome</a> at the moment.  See how to <a href="//github.com/datanews/locator/" target="_blank">deploy Locator</a> for yourself or your organization.',tilesets:{"CartoDB Positron":{url:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a target="_blank" href="http://cartodb.com/attributions">CartoDB</a>'},"CartoDB Positron Dark":{url:"http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a target="_blank" href="http://cartodb.com/attributions">CartoDB</a>'},"Stamen Toner":{url:"http://tile.stamen.com/toner/{z}/{x}/{y}.png",attribution:'Map tiles by <a target="_blank" href="http://stamen.com">Stamen Design</a>, under <a  target="_blank" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a  target="_blank" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_blank" href="http://www.openstreetmap.org/copyright">ODbL</a>'},"Mapbox Streets (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.np44bm6o/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>"},"Mapbox Run, Bike, Hike (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.oee1c53c/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>"},"Mapbox Satellite (via WNYC)":{url:"https://api.mapbox.com/v4/jkeefe.oee0fah0/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamtlZWZlIiwiYSI6ImVCXzdvUGsifQ.5tFwEhRfLmH36EUxuvUQLA",attribution:"&copy; <a target='_blank' href='https://www.mapbox.com/about/maps/'>Mapbox</a> &copy; <a target='_blank' href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a>; &copy; <a target='_blank' href='https://www.digitalglobe.com/'>DigitalGlobe</a>"},"Bing Maps Ariel (via WNYC)":{type:"BingLayer",key:"Aj4s_S9wMF1L8vcqCP7_ZWxtllCsUhD-LB8LY4KIOrkzHuMguY8NoZ_Gk4_lf4oD",options:{type:"Aerial"},attribution:"&copy; Bing",preview:"https://ecn.t2.tiles.virtualearth.net/tiles/a0320101103.jpeg?g=5306"},"Bing Maps Aerial w/ Labels (via WNYC)":{type:"BingLayer",key:"Aj4s_S9wMF1L8vcqCP7_ZWxtllCsUhD-LB8LY4KIOrkzHuMguY8NoZ_Gk4_lf4oD",options:{type:"AerialWithLabels"},attribution:"&copy; Bing",preview:"https://ecn.t2.tiles.virtualearth.net/tiles/h0320101103.jpeg?g=5306&mkt="}},tileset:"CartoDB Positron",zoom:17,minZoom:1,maxZoom:20,lat:40.74844,lng:-73.98566,embedAttribution:!1,overrideAttribution:void 0,mini:!0,miniControl:!0,miniWidth:"15w",miniHeight:"15w",miniZoomOffset:-6,miniExtentStyles:{fill:!1,stroke:!0,color:"#000000",opacity:.9,weight:1.5},miniStyles:{backgroundColor:"#FFFFFF",padding:3,shadow:!0,shadowColor:"rgba(0, 0, 0, 0.65)",shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1},markers:[{text:"Empire State Building",lat:40.74844,lng:-73.98566}],markerDefaults:{text:"",background:"rgba(0, 0, 0, 0.9)",foreground:"rgba(255, 255, 255, 0.9)",radius:5,fontSize:16,font:'"Open Sans", Helvetica, Arial, sans-serif',labelDistance:20,labelWidth:3,padding:10},markerBackgrounds:["rgba(0, 0, 0, 0.9)","rgba(255, 255, 255, 0.9)","rgba(88, 88, 88, 0.9)","rgba(200, 200, 200, 0.9)","rgba(51, 102, 255, 0.9)","rgba(255, 51, 204, 0.9)","rgba(0, 245, 61, 0.9)","rgba(245, 0, 61, 0.9)","rgba(184, 0, 245, 0.9)"],markerForegrounds:["rgba(0, 0, 0, 0.9)","rgba(255, 255, 255, 0.9)"],draggableMarker:o.icon({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wwLFSU1meAbBQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAACOUlEQVR42u3bP0sjQRjH8W8S/wYVFEFR1LOxMaSxsrKQlPcaBH1bCvcSvMrCQhAsbE5FwcZ/hVUQQcQ7CLheMSPYqjOzzyS/DyzpdnZ/u5k8s/sERERERERERERERERERERERERERERExJCKkeOoA7PAFDANjABjQD/QAZ791vbbPfDS6wH2AfPAug/rsx6AI+AWeO2lAKtAA2gF3Oc+cAEU3R7gOLAZad9vwC/gsVsDbAHNBONcA7vdFuAGMJnwYj0B2ykGqiUYYwuYSDxVDPl59iT3ADdKCO/dIPADOM81wBawWHKZNuqDvItZUsT6tW1iwwowl1OA1Yilylf9zCnAhsEl6zCwlkOAfYFXGCE1cwhwHrsGYoQYOsB1bFu1HGCdrz1VSaluOcBZ7KsCC1YDnCIPy1YDnM4kwCWrAY7Qg0IGONaD5xx0Z/2ZBFixGmAnkwDfrAb4nEmAhQLs0juwnUmAVwrwey6tBnifyfx3YzXAF1y7hWV/TReVuF4Vy46tB3hrOLwOcGo9wFdco49FZ+bXhd5F6ForgH/AYS4BFrguKUv2Yu041ov1R1yXlAV/Ys7N1YgHvovrkipTGziIOUAtwdVv4PpTypj3dmIPkqK97QTXJTWa+M7bSTFQLdEJnfu7cCbRnPc71ZVK3SM9h2v0GY70ld1LXcyX9TeHNVybxUCgFcZZrDrPaoDvmrh2i/onK4LCPxg4jrE8yynAjxZwL72XPpRYFb+qKfznFe553g0iAvwHgeJXccwK1poAAAAASUVORK5CYII=",iconSize:[80,80],iconAnchor:[40,55],popupAnchor:[-75,0]}),drawing:!0,drawingStyles:{fill:!1,stroke:!0,color:"#00B8F5",opacity:.9,weight:5,fillOpacity:.3},geojson:!1,drawingStrokes:["#00B8F5","#F5003D","#F500B8","#F5B800","#00F53D","#FFFFFF","#000000"],drawingFills:["#00B8F5","#F5003D","#F500B8","#F5B800","#00F53D","#FFFFFF","#000000"],widths:{Small:400,Medium:600,Large:800},width:"Medium",ratios:{"1:1":1,"4:3":4/3,"16:9":16/9},ratio:"4:3",controlsOpen:!0,centerToMarker:!0,markerToCenter:!0,geocoder:c.google,superClass:void 0},t),this.id=a.uniqueId("locator-"),this.el=this.options.el,this.updateOptions(),this.originalOptions=l.clone(this.options),this.options=this.load(this.options),this.history=[],this.historyIndex=0,this.save(!0),this.throttledDrawMaps=a.throttle(a.bind(this.drawMaps,this),500),a.isFunction(this.options.geocoder)&&(this.throttledGeocoder=a.throttle(a.bind(this.options.geocoder,this),500)),this.drawInterface()};a.extend(h.prototype,{drawInterface:function(){var t={controlsOpen:this.options.controlsOpen};this["interface"]=new r({el:this.options.el,template:this.options.template,data:{options:this.options,noGenerate:t,isGeocoding:!1,geocodeInput:"",_:a},events:{tap:s}}),this["interface"].observe("options",a.bind(function(){this.ignoreObservers||(this.updateOptions(),this["interface"].update(),this.save(!this.ignoreHistory),this.ignoreHistory=!1,this.throttledDrawMaps())},this),{init:!1}),this["interface"].observe("geocodeInput",a.bind(function(t){a.isFunction(this.throttledGeocoder)&&this.throttledGeocoder(t,a.bind(function(t,e){t&&e&&(this.set("options.lat",t),this.set("options.lng",e))},this))},this),{init:!1}),this["interface"].on("undo",a.bind(function(){this.ignoreHistory=!0,this.undo(),this.set("options",this.options)},this)),this["interface"].on("redo",a.bind(function(){this.ignoreHistory=!0,this.redo(),this.set("options",this.options)},this)),this["interface"].on("generate",a.bind(this.generate,this)),this["interface"].on("resetOptions",a.bind(function(){this.reset(),this.set("options",this.options)},this)),this["interface"].on("toggle",a.bind(function(t,e){this.set(e,!this.get(e))},this)),this["interface"].on("set",a.bind(function(t,e,i){this.set(e,i)},this)),this["interface"].on("setMarker",a.bind(function(t,e,i,o){var n=this.get("options.markers."+e);n&&this.set("options.markers."+e+"."+i,o)},this)),this["interface"].on("setDrawing",a.bind(function(t,e,i){this.set("options.drawingStyles."+e,i)},this)),this["interface"].on("marker-to-center",a.bind(function(t,e){var i=this.map.getCenter(),o={};o["options.markers."+e+".lat"]=i.lat,o["options.markers."+e+".lng"]=i.lng,this.set(o)},this)),this["interface"].on("center-to-marker",a.bind(function(t,e){var i=this.get("options.markers."+e);i&&this.set({"options.lat":i.lat,"options.lng":i.lng})},this)),this["interface"].on("remove-marker",a.bind(function(t,e){this.options.markers.splice(e,1)},this)),this["interface"].on("add-marker",a.bind(function(){var t=this.map.getCenter(),e={lat:t.lat,lng:t.lng};this.get("options.markers").push(this.updateMarker(e))},this)),this.drawMaps()},set:function(t,e){this["interface"]&&this["interface"].set(t,e)},get:function(t){return this["interface"]?this["interface"].get(t):void 0},drawMaps:function(){this.drawMap(),this.drawGeoJSON(),this.drawMarkers(),this.drawMinimap(),this.drawDrawingLayer(),this.fixMapVerticalAlign()},updateOptions:function(){var t=this.options;return t=this.alterOptions("preDraw",this.options),a.each(t.markers,a.bind(function(e,i){t.markers[i]=this.updateMarker(t.markers[i])},this)),t.tilesets=this.parseTilesets(t.tilesets),t.drawingStylesInvisible=a.clone(t.drawingStyles),t.drawingStylesInvisible.opacity=0,t.drawingStylesInvisible.fillOpacity=0,t},alterOptions:function(t,e){return a.isFunction(this.options[t])?a.bind(this.options[t],this)(e):e},drawMap:function(t){t=a.isUndefined(t)?!0:t;var e,i,n,r=this.getEl(".locator-map");r.id=this.id+"-map",n=[this.options.lat,this.options.lng,this.options.zoom],this.map&&!t?(n[0]=this.map.getCenter().lat,n[1]=this.map.getCenter().lng,n[2]=this.map.getZoom(),this.map.remove()):this.map&&this.map.remove(),e=a.size(this.options.widths)?this.options.widths[this.options.width]:a.isNumber(this.options.width)?this.options.width:r.getBoundingClientRect().width,i=a.size(this.options.ratios)?e/this.options.ratios[this.options.ratio]:a.isNumber(this.options.ratio)?e/this.options.ratio:r.getBoundingClientRect().height,r.style.width=e+"px",r.style.height=i+"px",this.map=new o.Map(r.id,{minZoom:this.options.minZoom,maxZoom:this.options.maxZoom,attributionControl:!1,trackResize:!1}),this.map.setView([n[0],n[1]],n[2]),this.mapLayer=this.makeTileLayer(this.options.tilesets[this.options.tileset],-100),this.map.addLayer(this.mapLayer),this.map.on("moveend",a.bind(function(){var t=this.map.getCenter();this.isDrawing||this.set({"options.lat":t.lat,"options.lng":t.lng,"options.zoom":this.map.getZoom()})},this))},getGeoJSON:function(){var t=[];return this.drawLayer.eachLayer(function(e){e&&e.toGeoJSON&&t.push(e.toGeoJSON())}),this.options.geojson={type:"FeatureCollection",features:t},this.geojsonCanvasLayer&&this["interface"].update(),this.options.geojson},setGeoJSON:function(){this.drawLayer&&this.options.geojson&&(this.drawLayer.clearLayers(),o.geoJson(this.options.geojson,{style:a.clone(this.options.drawingStylesInvisible)}).eachLayer(a.bind(function(t){t.addTo(this.drawLayer)},this)))},drawDrawingLayer:function(){this.options.drawing&&(this.drawLayer=new o.FeatureGroup,this.map.addLayer(this.drawLayer),this.mapDraw=new o.Control.Draw({draw:{marker:!1,circle:!1,polyline:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language,shapeOptions:a.clone(this.options.drawingStyles)},polygon:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language,shapeOptions:a.clone(this.options.drawingStyles)},rectangle:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language,shapeOptions:a.clone(this.options.drawingStyles)}},edit:{featureGroup:this.drawLayer,edit:{selectedPathOptions:a.clone(this.options.drawingStyles)}}}),this.map.addControl(this.mapDraw),this.setGeoJSON(),this.map.on("draw:created",a.bind(function(t){t.layer.setStyle(a.clone(this.options.drawingStylesInvisible)),this.drawLayer.addLayer(t.layer),this.getGeoJSON()},this)),this.map.on("draw:edited",a.bind(this.getGeoJSON,this)),this.map.on("draw:deleted",a.bind(this.getGeoJSON,this)),this.map.on("draw:drawstart",a.bind(function(){this.isDrawing=!0},this)),this.map.on("draw:drawstop",a.bind(function(){this.isDrawing=!1},this)),this.map.on("draw:editstart",a.bind(function(){this.isDrawing=!0},this)),this.map.on("draw:editstop",a.bind(function(){this.isDrawing=!1},this)),this.map.on("draw:deletestart",a.bind(function(){this.isDrawing=!0},this)),this.map.on("draw:deletestop",a.bind(function(){this.isDrawing=!1},this)))},drawGeoJSON:function(){return this.geojsonCanvasLayer=o.tileLayer.canvas(),this.options.geojson?(this.geojsonCanvasLayer.drawTile=a.bind(this.drawGeoJSONTile,this),void this.map.addLayer(this.geojsonCanvasLayer)):this.geojsonCanvasLayer},drawMinimap:function(){var t;if(this.options.mini){var e=this.getEl(".locator-map").getBoundingClientRect().width,i=this.getEl(".locator-map").getBoundingClientRect().height,n=a.isNumber(this.options.miniWidth)?this.options.miniWidth:-1!==this.options.miniWidth.indexOf("w")?+this.options.miniWidth.replace("w","")/100*e:+this.options.miniWidth.replace("h","")/100*i,r=a.isNumber(this.options.miniHeight)?this.options.miniHeight:-1!==this.options.miniHeight.indexOf("w")?+this.options.miniHeight.replace("w","")/100*e:+this.options.miniHeight.replace("h","")/100*i;this.minimapLayer=this.makeTileLayer(this.options.tilesets[this.options.tileset]),this.miniMap=new o.Control.MiniMap(this.minimapLayer,{width:n,height:r,zoomLevelOffset:this.options.miniZoomOffset,aimingRectOptions:{fill:!1,stroke:!1}}),this.map.addControl(this.miniMap),this.miniMap._miniMap.addLayer(this.drawMiniCanvasLayer(this.options.miniExtentStyles)),t=this.getEl(".locator-map .leaflet-control-minimap"),a.each(this.miniStylesToCSS(this.options.miniStyles),function(e,i){t.style[i]=e})}},makeTileLayer:function(t,e){var i=t.options?a.clone(t.options):{};i=e?a.extend(i,{zIndex:e}):i;var n;return n="BingLayer"===t.type?new o.BingLayer(t.key,i):new o.TileLayer(t.url,i)},drawMiniCanvasLayer:function(t){return this.miniCanvasLayer=o.tileLayer.canvas(),this.miniCanvasLayer.drawTile=a.bind(function(e,i,n){var a=e.getContext("2d");a.clearRect(0,0,e.width,e.height);var r={};r.nwPoint=i.multiplyBy(256),r.sePoint=r.nwPoint.add(new o.Point(256,256)),r.nwCoord=this.map.unproject(r.nwPoint,n,!0),r.seCoord=this.map.unproject(r.sePoint,n,!0),
r.bCoord=o.latLngBounds([[r.nwCoord.lat,r.seCoord.lng],[r.seCoord.lat,r.nwCoord.lng]]),r.bPoint=[r.nwPoint,r.sePoint];var s=this.map.getBounds(),l=this.map.project(s.getNorthWest(),n,!0),d=this.map.project(s.getSouthEast(),n,!0);a.beginPath(),a.rect(l.x-r.nwPoint.x,l.y-r.nwPoint.y,d.x-l.x,d.y-l.y),a=this.leafletStylesToCanvas(t,a),a.closePath()},this),this.map.on("moveend",a.bind(function(){this.miniCanvasLayer.redraw()},this)),this.miniCanvasLayer},updateMarker:function(t){return a.extend(a.clone(this.options.markerDefaults),t)},drawMarkers:function(){this.markerCanvas&&this.map&&this.markerCanvas._map&&this.map.removeLayer(this.markerCanvas),this.markerCanvas=o.tileLayer.canvas(),this.markerCanvas.drawTile=a.bind(this.drawMarkerTile,this),this.markerCanvas.addTo(this.map),a.each(this.options.markers,a.bind(function(t,e){this.draggableMarker(this.options.markers[e],e)},this))},draggableMarker:function(t,e){this.draggableMarkers=this.draggableMarkers||{};var i=this.draggableMarkers[e];i&&this.map&&i._map&&(i.clearAllEventListeners(),this.map.removeLayer(i)),this.draggableMarkers[e]=i=o.marker(o.latLng(t.lat,t.lng),{icon:this.options.draggableMarker,draggable:!0,opacity:0,title:"Drag marker here"}).addTo(this.map),i.on("mouseover",function(t){i.isDragging||t.target.setOpacity(.3)}),i.on("mouseout",function(t){i.isDragging||t.target.setOpacity(0)}),i.on("dragstart",function(t){i.isDragging=!0,t.target.setOpacity(1)}),i.on("dragend",a.bind(function(e){i.isDragging=!1,e.target.setOpacity(0);var o=e.target.getLatLng();t.lat=o.lat,t.lng=o.lng,this["interface"].update("options.markers")},this))},drawMarkerTile:function(t,e,i){var o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),a.each(this.options.markers,a.bind(function(o){this.drawMarker(o,t,e,i)},this))},drawMarker:function(t,e,i,n){var r,s,l,d=e.getContext("2d"),c=t.text.split("<br>");c=a.map(c,function(t){return t.trim()});var h=c.length,p=1.25,u=t.fontSize*p*h+2*t.padding,g={};g.nwPoint=i.multiplyBy(256),g.sePoint=g.nwPoint.add(new o.Point(256,256)),g.nwCoord=this.map.unproject(g.nwPoint,n,!0),g.seCoord=this.map.unproject(g.sePoint,n,!0),g.bCoord=o.latLngBounds([[g.nwCoord.lat,g.seCoord.lng],[g.seCoord.lat,g.nwCoord.lng]]),g.bPoint=[g.nwPoint,g.sePoint],g.locCoord=o.latLng(t.lat,t.lng),g.locPoint=this.map.project(g.locCoord,n,!0),r={x:g.locPoint.x-g.nwPoint.x,y:g.locPoint.y-g.nwPoint.y},d.beginPath(),d.translate(r.x-t.radius,r.y-t.radius),d.fillStyle=t.background,d.fillRect(0,0,2*t.radius,2*t.radius),d.setTransform(1,0,0,1,0,0),d.closePath(),d.beginPath(),d.translate(r.x-t.labelWidth/2,r.y-t.radius-t.labelDistance),d.fillStyle=t.background,d.fillRect(0,0,t.labelWidth,t.labelDistance),d.setTransform(1,0,0,1,0,0),d.closePath(),d.beginPath(),d.font=t.fontSize+"px "+t.font,d.fillStyle=t.foreground,d.textAlign="center",s=a.max(c,function(t){return d.measureText(t).width}),s=d.measureText(s).width,l=s+2*t.padding,d.closePath(),d.beginPath(),d.translate(r.x-l/2,r.y-t.radius-t.labelDistance-u),d.fillStyle=t.background,d.fillRect(0,0,l,u),d.setTransform(1,0,0,1,0,0),d.closePath(),a.each(c,a.bind(function(e,i){var o=1;d.beginPath(),d.translate(r.x,r.y-t.radius-t.labelDistance-u+t.padding+o+t.fontSize*p*i),d.font=t.fontSize+"px "+t.font,d.fillStyle=t.foreground,d.textAlign="center",d.textBaseline="top",d.fillText(e,0,0),d.setTransform(1,0,0,1,0,0),d.closePath()},this))},drawGeoJSONTile:function(t,e,i){var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);var r={};r.nwPoint=e.multiplyBy(256),r.sePoint=r.nwPoint.add(new o.Point(256,256)),r.nwCoord=this.map.unproject(r.nwPoint,i,!0),r.seCoord=this.map.unproject(r.sePoint,i,!0),r.bCoord=o.latLngBounds([[r.nwCoord.lat,r.seCoord.lng],[r.seCoord.lat,r.nwCoord.lng]]),r.bPoint=[r.nwPoint,r.sePoint],a.each(this.options.geojson.features,a.bind(function(t){var e=a.clone(this.options.drawingStyles);"Polygon"===t.geometry.type?(n.beginPath(),a.each(t.geometry.coordinates,a.bind(function(t){a.each(t,a.bind(function(t,e){var o=this.map.project([t[1],t[0]],i,!0);0===e?n.moveTo(o.x-r.nwPoint.x,o.y-r.nwPoint.y):n.lineTo(o.x-r.nwPoint.x,o.y-r.nwPoint.y)},this)),n.closePath(),n=this.leafletStylesToCanvas(e,n)},this))):"LineString"===t.geometry.type&&(e.fill=!1,n.beginPath(),a.each(t.geometry.coordinates,a.bind(function(t,o){var a=this.map.project([t[1],t[0]],i,!0);0===o?n.moveTo(a.x-r.nwPoint.x,a.y-r.nwPoint.y):n.lineTo(a.x-r.nwPoint.x,a.y-r.nwPoint.y),n=this.leafletStylesToCanvas(e,n)},this)))},this))},generate:function(){this.getEl(".locator-map .leaflet-control-zoom").style.display="none",this.options.mini&&(this.getEl(".locator-map .leaflet-control-minimap").style.display="none"),this.options.drawing&&(this.getEl(".locator-map .leaflet-draw").style.display="none"),a.delay(a.bind(function(){n(this.getEl(".locator-map"),{useCORS:!0,onrendered:a.bind(function(t){return this.getEl(".locator-map .leaflet-control-zoom").style.display="block",this.options.mini&&(this.getEl(".locator-map .leaflet-control-minimap").style.display="block"),this.options.drawing&&(this.getEl(".locator-map .leaflet-draw").style.display="block"),this.options.mini?void n(this.getEl(".locator-map .leaflet-control-minimap"),{useCORS:!0,onrendered:a.bind(function(e){var i=this.drawCanvasMiniMap(t,e);this.preview(i),this["export"](i)},this)}):(this.preview(t.getContext("2d")),void this["export"](t.getContext("2d")))},this)})},this),300)},drawCanvasMiniMap:function(t,e){var i=t.getContext("2d"),o=this.getEl(".locator-map .leaflet-control-minimap"),n=o.getBoundingClientRect().width,a=o.getBoundingClientRect().height,r=this.options.miniStyles,s=10,l=10;return i.beginPath(),i.fillStyle=r.backgroundColor,r.shadow&&(i.shadowColor=r.shadowColor,i.shadowBlur=r.shadowBlur,i.shadowOffsetX=r.shadowOffsetX,i.shadowOffsetY=r.shadowOffsetY),i.fillRect(i.canvas.width-s-n-2*r.padding,i.canvas.height-l-a-2*r.padding,n+2*r.padding,a+2*r.padding),i.closePath(),i.beginPath(),i.shadowColor=0,i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0,i.drawImage(e,i.canvas.width-s-n-r.padding,i.canvas.height-l-a-r.padding,n,a),i.closePath(),i},preview:function(t){this.getEl(".preview img").src=t.canvas.toDataURL()},"export":function(t){var e=this.options.markers&&this.options.markers[0]?this.options.markers[0].text:"",i=this.getEl(".download-link");i.href=t.canvas.toDataURL(),i.download=l.makeID(e)+".png",i.click()},getEl:function(t){return document.querySelector(this.el+" "+t)},miniStylesToCSS:function(t){var e={"background-color":t.backgroundColor,border:t.padding+"px solid "+t.backgroundColor};return t.shadow&&(e["box-shadow"]=t.shadowOffsetX+"px "+t.shadowOffsetY+"px "+t.shadowBlur+"px "+t.shadowColor),e},leafletStylesToCanvas:function(t,e){return t.fill&&(e.globalAlpha=a.isUndefined(t.fillOpacity)?1:t.fillOpacity,e.fillStyle=t.fillColor||t.color,e.fill(t.fillRule||"evenodd")),t.stroke&&0!==t.weight&&(e.globalAlpha=a.isUndefined(t.opacity)?1:t.opacity,e.strokeStyle=t.color,e.lineCap=t.lineCap||"round",e.lineJoin=t.lineJoin||"round",e.lineWidth=t.weight,e.stroke()),e},save:function(t){var e=l.clone(this.options);delete e.draggableMarker,delete e.template,a.each(e,function(t,i){a.isFunction(t)&&delete e[i]}),window.localStorage.setItem("options",JSON.stringify(e)),t&&(this.historyIndex>=0&&this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.push(l.clone(e)),this.historyIndex=this.history.length-1,this.canDo())},load:function(t){var e=window.localStorage.getItem("options");return e?(e=JSON.parse(e),a.extend(t,e)):t},reset:function(){this.options=a.extend(this.options,l.clone(this.originalOptions))},undo:function(){this.historyIndex>0&&(this.historyIndex=this.historyIndex-1,this.options=a.extend(this.options,l.clone(this.history[this.historyIndex]))),this.canDo()},redo:function(){this.historyIndex<this.history.length-1&&(this.historyIndex=this.historyIndex+1,this.options=a.extend(this.options,l.clone(this.history[this.historyIndex]))),this.canDo()},canDo:function(){this.set({canUndo:this.historyIndex>0,canRedo:this.historyIndex<this.history.length-1})},parseTilesets:function(t){return a.each(t,function(e,i){a.isString(e)&&(t[i]={url:e}),!t[i].preview&&t[i].url&&(t[i].preview=t[i].url.replace("{s}","a").replace("{x}","301").replace("{y}","385").replace("{z}","10"))}),t},fixMapVerticalAlign:function(){var t=this.getEl(".locator-display");d.isOverflowed(t,"y")?t.classList.add("overflowed-y"):t.classList.remove("overflowed-y")}}),e.exports=h},{"../libs/html2canvas.js":"UzntfK","../libs/leaflet-plugins.bing.js":3,"../libs/ractive-transitions-slide.js":4,"./js/dom.js":6,"./js/geocode.js":7,"./js/utils.js":8}],6:[function(t,e,i){"use strict";function o(t,e){return e?"y"===e?t.scrollHeight>t.clientHeight:"x"===e?t.scrollWidth>t.clientWidth:!1:t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth}e.exports={isOverflowed:o}},{}],7:[function(t,e,i){"use strict";function o(t,e){var i=new XMLHttpRequest,o="https://maps.googleapis.com/maps/api/geocode/json?address="+encodeURIComponent(t),a=n.once(e);i.onreadystatechange=function(){var t;200===i.status&&i.responseText&&(t=JSON.parse(i.responseText),t&&t.results&&t.results.length&&a(t.results[0].geometry.location.lat,t.results[0].geometry.location.lng))},i.open("GET",o),i.send()}var n=t("lodash");e.exports={google:o}},{}],8:[function(t,e,i){"use strict";function o(t){function e(t){return a.isElement(t)?t.cloneNode(!0):a.isDate(t)?new Date(t):a.cloneDeep(t)}return a.cloneDeepWith(t,e)}function n(t){return t=t?t.toString():"",t=t.toLowerCase().trim().replace(/\W+/g,"-"),t=t?t:"locator",a.uniqueId(t+"-")}var a=t("lodash");e.exports={clone:o,makeID:n}},{}]},{},[5])(5)});